# 마케팅 데이터 분석

- 기간: 2022.08
- 기업데이터 다뤄보기
  - 내부 규정상, 데이터는 업로드 불가이지만 코드는 올려야징
 
 </br>
 
- 기업 내부 데이터 이외에 추가 데이터 필요함
- prediction -> clustering -> NLP 분석 (단, nlp에는 외부 데이터를 사용한다.)

</br>

- 본 데이터의 가장 큰 특징은 panel data라는 것이다. 그동안 횡단자료를 많이 분석하였고 종단 자료는 시계열에서 딱 한번 다뤄 본 적이 있었다. 하지만 이번 데이터는 종단 + 횡단자료의 두가지 성질을 모두 갖춘 패널 데이터이다. 이 데이터를 분석하기 위해서는 다음과 같은 두가지 생각을 했다.
  - 1) 자신있는 횡단자료 성질 이용해 분석하기
    - 데이터의 시계열성을 요약통계량으로 데이터를 변환시켜(시계열성 제거) 기존에 했던 방식으로 횡단자료로 분석
  - 2) 종단자료 성질 살리기
    - 데이터의 시계열성을 살리게 되면, 더욱 풍부한 정보를 담을 수 있지만 반복 측정자료가 되어 꽤 까다로운 분석 기법이 필요하다.
- 위에 2개의 방법 중, b번을 택했다. 조금 어렵고 까다로울 수 있지만 패널 데이터의 특성을 살려서 분석해보는 경험도 도움이 될 것이라고 생각했다. 사실 현실세계의 데이터에는 종단 or 횡단 각각의 특성을 갖는 데이터보다는 패널 데이터가 더 많이 관측될테니까...!
- 2번을 선택함으로써 FE를 더 풍부하게 할 수 있었다. 횡단자료는보통 FE를 할 때, 같은 행에서만 진행하지만(혹은 통계량을 위해 전체 row를 사용하기도 하지만), 종단자료의 FE는 lag변수를 추가할 수 있었다. 현재 row의 시간보다 이전에 있는 데이터의 통계량을 사용해 시차 변수를 만들고, 이를 데이터 분석에 활용해보았다.


- data leakage issue -> train-test split은 어떻게 해야하나?
  - 고객별 가장 마지막으로 관측된 데이터를 test data로 사용한다.

- 정말 간만에 재밌게 한 프로젝트!! 36시간 동안 잠 한숨도 안자고 코드짜고, 실행하고, 많은 것을 배웠다~!
  - 조만간 하고 싶었던 기법들 다 적용해보고 업로드 해야지

## 아쉬웠던 점
- 데이터 용량이 너무나도 커서 코드 한줄을 수행하는데도 너무나 많은 시간이 걸렸다.
- 클러스터가 좋은 결과를 내지 못했다. -> 다른 클러스터 기법써볼걸
- 팀 프로젝트였는데 나만 일했다. -> 함께 일하는 방법에 대해 고민해보자... 사실 팀원들이 나보다 나이가 많아서 일을 잘 못시켰다.


# TIL
1. ConnectionError: ('Connection aborted.', OSError("(10054, 'WSAECONNRESET')")) \*07.13 
  - 원인
    - 웹페이지에서 안티 크롤링 시행(무분별한 크롤링 막아내기 위함)
  - 상태
    - selenium으로는 크롤링 가능하지만, bs4에서는 불가능 
    - 특히 requests자체 불가능 
    - 하지만 크롤링 속도 높이기 위해 bs4를 통해 해야만 하는 상황
  - 해결
    - requests에서 header옵션을 준다. User-Agent에서 Mozilla/5.0으로 변경하는 코드 삽입
    - `re=requests.get(url,header={'User-Agent':'Mozilla/5.0'})`
    - 크롤링할 페이지의 html 파일을 보고, 가장 상위에 있는 `data-useragent` 확인 후, header 딕셔너리 User-Agent키에 해당하는 값으로 넣는다.

2. While 문 \*08.09
- while 문은 되도록이면 쓰지 말자
- 약 500만개의 데이터를 돌려보면서, while 문을 넣어봤는데 26줄짜리 코드가 2시간이 지나도 output이 안나왔다.
- 처음에는 데이터가 많아서 그런 줄알았는데, while문은 시간복잡도가 크기 때문에 현업에서 쓰이지 않는 다는 이야기를 들었다.
  - 다음에는 시간복잡도를 계산하는 방법도 알아보자!
- for if 문으로 바꿔서 구현하기~!

3. CLTV
- 마케팅 데이터 분석에서 중요한 지표로 사용되고 있는 Customer LifeTime Value.
- 이 지표는 간단하게 계산될 수 있지만, 나는 이 지표에 의문점이 들었다.
- 과연 이 지표가 "Life Time"을 반영하고 있는가? 고객의 생애주기를 고려하고 있는 것이 아닌, 시장의 이탈률과 점유율로만 계산되는 지표를 "lifetime value"라고 말할 수 있나?
- 더 정확한 지표가 필요할 듯 싶다.
